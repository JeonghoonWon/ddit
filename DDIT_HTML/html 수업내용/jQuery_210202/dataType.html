<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<link rel = "stylesheet" href = "../css/public.css">
<script src ="../js/jquery-3.5.1.min.js"></script>
<style>
div.box{
	height : 400px;
}

.box div{
	width : 200px;
	height : 250px;
	border : 1px solid red;
	margin : 5px;
	padding : 10px;
	float : left;
	overflow : auto;
		
}
</style>

<script>
$(function() {
	// 클릭 전 function 이 준비되면
	// request 객체 생성
	xhr = new XMLHttpRequest();
	
	
	$('#text').on('click',function(){
		
		// 요청
		xhr.open("get","text.jsp",true);   /* get 이 기본. 보내줄땐 post를 쓴다.  */
		xhr.send();
		
		// 응답
		xhr.onreadystatechange = function(){
			if(this.readyState == 4 && this.status == 200) {
				// 응답
				res = this.responseText;
				// res = 홍길동/개나리/진달래/무궁화/백일홍/수선화  
				// split("/") 으로 문자열 나누고 배열로 받게 된다.
				
				code = res.split("/");
				console.log("split 으로 나눈 것 :" + code);
				vhtml = "<ul>";
				
				$.each(code,function(i){
					//html += "<li>" + code[i] +"</li>";
					vhtml += `<li> ${code[i]} </li>`;
				})
				vhtml +="</ul>";
				$('#result1').html(vhtml);
				
			}
		}
	})
	
	$('#arr').on('click',function(){
		
		xhr.open("get",'arr.jsp',true);
		xhr.send();
		
		xhr.onreadystatechange = function(){
			if(this.readyState == 4 && this.status == 200 ) {
				// 응답
				res = this.responseText;
				//res = ["홍길동","수선화","백일홍","라일락","벤자민"]
				// json 배열이기 때문에 res를 json으로 형 변환을 해줘야한다.
				jsonres = JSON.parse(res); 
				
				code = "<ol>";
				
				
				$.each(jsonres,function(i){
					code += "<li>" + jsonres[i] +"</li>";
					
					
				})
				code +="<ol>";
				$('#result2').html(code);
				
					
			}
		}
	})
	/* object 가 하나기 때문에 each반복문 돌 필요 없다. */
	$('#json').on('click',function(){
		//응답
		xhr.onreadystatechange = function(){
			
			if(this.readyState == 4 && this.status == 200 ) {
			
				res = JSON.parse(this.responseText);  
				console.log("res" + res);
				code = `이름 : ${res.name} <br>`;
				code += `전화번호 : ${res.tel} <br>`;
				code += `우편번호 : ${res.zip} <br>`;
				code += `주소 : ${res.addr} <br>`;
				
				$('#result3').html(code);
			}
		}
		
		//요청
		xhr.open("get", "json.jsp",true);
		xhr.send();
	})
	
	$('#jarr').on('click',function(){
		//요청
		xhr.open("get",'jsonarr.jsp',true);
		xhr.send();
		
		//응답
		xhr.onreadystatechange = function(){
			if(this.readyState == 4 && this.status == 200 ){
				
				res = JSON.parse(this.responseText);
				
				console.log("res:"+ res);
				
				code = "";
				$.each(res,function(i,v){
					code += `${i+1} 번째 회원정보 <br>`
					code += `이름 : ${v.name} <br>`;
					code += `전화번호 : ${v.tel} <br>`;
					code += `우편번호 : ${v.zip} <br>`;
					code += `주소 : ${v.addr} <br><br>`;
				})
				
				$('#result4').html(code);
				
				
			}
			
		}
		
	})
	
	
})
</script>

<title>Insert title here</title>
</head>
<body>

<div class="box">
		<br><br> 
		<input id="text" type="button" value="text">
		<input id="arr" type="button" value="arr">
		<input id="json" type="button" value="json"> <!--json Object  -->
		<input id="jarr" type="button" value="jsonarr"> <!-- json Array -->
		<br><br>
		<div id="result1"></div>
		<div id="result2"></div>
		<div id="result3"></div>
		<div id="result4"></div>
		
		</div>

</body>
</html>